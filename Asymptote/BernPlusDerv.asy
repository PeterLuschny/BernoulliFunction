import gsl;
import graph;
import settings;

size(500*2/3, 333*2/3, IgnoreAspect);

pair[] BernoulliNumber = {
(0,1), (1,1/2), (2,1/6),(3,0),(4,-1/30),(5,0),(6,1/42),
(7,0),(8,-1/30),(9,0),(10,5/66),(11,0),(12,-691/2730)
};

pair[] BernoulliDerivative = {
(0.000000, 0.577215),
(0.001972, 0.576928),
(0.003943, 0.576641),
(0.005915, 0.576354),
(0.007886, 0.576066),
(0.011830, 0.575491),
(0.015773, 0.574915),
(0.023659, 0.573762),
(0.031546, 0.572607),
(0.047318, 0.570292),
(0.063091, 0.567970),
(0.090539, 0.563912),
(0.117987, 0.559833),
(0.179722, 0.550581),
(0.241867, 0.541163),
(0.303716, 0.531687),
(0.361059, 0.522812),
(0.420433, 0.513535),
(0.481839, 0.503850),
(0.543047, 0.494107),
(0.606008, 0.483997),
(0.661463, 0.475020),
(0.723893, 0.464837),
(0.786579, 0.454535),
(0.846989, 0.444537),
(0.901847, 0.435403),
(0.967078, 0.424477),
(1.022338, 0.415172),
(1.086618, 0.404294),
(1.143516, 0.394622),
(1.205943, 0.383970),
(1.265388, 0.373791),
(1.327413, 0.363141),
(1.384371, 0.353339),
(1.445807, 0.342748),
(1.509623, 0.331734),
(1.565175, 0.322142),
(1.625172, 0.311783),
(1.687155, 0.301089),
(1.747794, 0.290642),
(1.806465, 0.280555),
(1.871609, 0.269387),
(1.930143, 0.259388),
(1.992642, 0.248757),
(2.049274, 0.239172),
(2.111189, 0.228752),
(2.169446, 0.219013),
(2.230341, 0.208907),
(2.289877, 0.199108),
(2.352206, 0.188945),
(2.412236, 0.179257),
(2.473625, 0.169460),
(2.534506, 0.159864),
(2.590450, 0.151158),
(2.654567, 0.141321),
(2.711914, 0.132659),
(2.773059, 0.123573),
(2.831582, 0.115029),
(2.896564, 0.105726),
(2.952833, 0.097836),
(3.016700, 0.089075),
(3.074908, 0.081278),
(3.138577, 0.072963),
(3.193514, 0.065976),
(3.256080, 0.058238),
(3.316516, 0.050991),
(3.376912, 0.043982),
(3.437086, 0.037237),
(3.494894, 0.030988),
(3.557387, 0.024493),
(3.616947, 0.018562),
(3.679631, 0.012599),
(3.736375, 0.007454),
(3.799087, 0.002052),
(3.859155, -0.002837),
(3.919077, -0.007431),
(3.981666, -0.011925),
(4.039312, -0.015783),
(4.098350, -0.019454),
(4.163534, -0.023174),
(4.222553, -0.026238),
(4.282912, -0.029072),
(4.344295, -0.031642),
(4.400717, -0.033728),
(4.460862, -0.035658),
(4.520549, -0.037277),
(4.584396, -0.038683),
(4.640738, -0.039647),
(4.705744, -0.040441),
(4.764408, -0.040867),
(4.822453, -0.041024),
(4.884869, -0.040903),
(4.947538, -0.040488),
(5.004558, -0.039860),
(5.065110, -0.038942),
(5.124203, -0.037804),
(5.188261, -0.036310),
(5.243688, -0.034810),
(5.307349, -0.032860),
(5.367193, -0.030818),
(5.426459, -0.028609),
(5.485773, -0.026226),
(5.546268, -0.023631),
(5.610393, -0.020716),
(5.669189, -0.017911),
(5.727228, -0.015033),
(5.789271, -0.011854),
(5.851179, -0.008596),
(5.906745, -0.005614),
(5.972567, -0.002033),
(6.027644, 0.000987),
(6.092062, 0.004526),
(6.153544, 0.007889),
(6.208439, 0.010862),
(6.270174, 0.014151),
(6.332319, 0.017383),
(6.394169, 0.020500),
(6.451511, 0.023280),
(6.510886, 0.026029),
(6.572291, 0.028714),
(6.633500, 0.031209),
(6.696460, 0.033566),
(6.751916, 0.035449),
(6.814345, 0.037334),
(6.877032, 0.038959),
(6.937441, 0.040254),
(6.992299, 0.041187),
(7.057530, 0.041978),
(7.112790, 0.042368),
(7.177070, 0.042485),
(7.233968, 0.042278),
(7.296395, 0.041706),
(7.355840, 0.040820),
(7.417865, 0.039536),
(7.474823, 0.038029),
(7.536260, 0.036054),
(7.600075, 0.033618),
(7.655627, 0.031183),
(7.715625, 0.028229),
(7.777608, 0.024835),
(7.838246, 0.021187),
(7.896917, 0.017364),
(7.962061, 0.012800),
(8.020596, 0.008431),
(8.083094, 0.003510),
(8.139727, -0.001154),
(8.201641, -0.006449),
(8.259898, -0.011589),
(8.320793, -0.017092),
(8.380329, -0.022568),
(8.442658, -0.028360),
(8.502688, -0.033954),
(8.564078, -0.039648),
(8.624959, -0.045219),
(8.680902, -0.050231),
(8.745019, -0.055797),
(8.802367, -0.060566),
(8.863511, -0.065381),
(8.922034, -0.069679),
(8.987016, -0.074034),
(9.043286, -0.077400),
(9.107152, -0.080706),
(9.165360, -0.083192),
(9.229030, -0.085277),
(9.283966, -0.086496),
(9.346532, -0.087182),
(9.406968, -0.087085),
(9.467364, -0.086195),
(9.527538, -0.084480),
(9.585347, -0.082016),
(9.647839, -0.078419),
(9.707399, -0.074059),
(9.770083, -0.068464),
(9.826827, -0.062492),
(9.889540, -0.054878),
(9.949608, -0.046586),
(10.009529, -0.037343),
(10.072118, -0.026669),
(10.129764, -0.015938),
(10.188802, -0.004083),
(10.253986, 0.009973),
(10.313006, 0.023521),
(10.373364, 0.038117),
(10.434747, 0.053651),
(10.491170, 0.068464),
(10.551315, 0.084722),
(10.611002, 0.101225),
(10.674848, 0.119147),
(10.731190, 0.135067),
(10.796197, 0.153389),
(10.854860, 0.169721),
(10.912905, 0.185530),
(10.975321, 0.201949),
(11.037990, 0.217617),
(11.095010, 0.230967),
(11.155562, 0.243990),
(11.214655, 0.255342),
(11.278713, 0.265883),
(11.334140, 0.273313),
(11.397801, 0.279661),
(11.427723, 0.281762),
(11.457645, 0.283259),
(11.472462, 0.283767),
(11.487278, 0.284117),
(11.502095, 0.284304),
(11.516911, 0.284326),
(11.531740, 0.284178),
(11.546568, 0.283857),
(11.561396, 0.283360),
(11.576225, 0.282683),
(11.606473, 0.280731),
(11.636721, 0.277989),
(11.700845, 0.269438),
(11.759641, 0.258152),
(11.817681, 0.243597),
(11.879724, 0.224104),
(11.941631, 0.200435),
(12.000000, 0.174129)
};

guide g;
for(int i = 0; i < BernoulliDerivative.length; ++i)
    g=g--(BernoulliDerivative[i].x,BernoulliDerivative[i].y);

path BernoulliDerivativePath = g;

// Function.
real bern(real x) {
    if(x==0.0){ return 1; } else { return -x*zeta(1-x); }
}

pen mybrown = RGB(120, 0, 14);
pen myblue  = RGB(0, 14, 120);

draw(BernoulliDerivativePath, mybrown+linewidth(0.45mm));
draw(graph(bern, -0.01, 12), myblue+linewidth(0.45mm));

dot(BernoulliNumber, red, FillDraw);
pair gamma = (0.0, 0.577215);
dot(gamma, purple, FillDraw);

xlimits(-0.06, 12.06, Crop);
ylimits(-0.27, 1.01, Crop);

xaxis( RightTicks(Label(fontsize(12)), 
    new real[]{ 2, 4, 6, 8, 10, 12}));
yaxis(Left,   LeftTicks(Label(fontsize(12)),  
    new real[]{-.25, .25, .5, .75, 1}));

label("$\phantom{-}\ \mathbf{B}(s)\, = -s\mathbf{\zeta}(1-s)$", (8.3,0.925), myblue+fontsize(12));
label("$-\mathbf{B}'(s) = -\mathbf{\zeta}(1-s) + x \mathbf{\zeta}'(1-s)$", (7.1, 0.800), mybrown+fontsize(12));
label("$\mathbf{\gamma}$", (-0.55, 0.58), purple+fontsize(14));

// Origin.
labelx("$O$",0,SW);

shipout("BernPlusDerv", bbox(0.25cm));
